<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title> 购物页 </title>
  <style>
    :root{
      --bg:#f7f7fb;        /* 背景 */
      --card:#ffffff;       /* 卡片 */
      --text:#1f2937;       /* 文字 */
      --sub:#6b7280;        /* 次级文字 */
      --brand:#7c3aed;      /* 品牌色 */
      --accent:#10b981;     /* 强调色 */
      --danger:#ef4444;     /* 警示 */
      --muted:#e5e7eb;      /* 边框/分隔 */
      --radius:16px;        /* 统一圆角 */
      --shadow:0 10px 20px rgba(31,41,55,.08);
      --gutter:16px;        /* 页面水平内边距 */
    }
    *{box-sizing:border-box}
    html,body{height:100%;min-height:100svh}
    body{margin:0;background:var(--bg);color:var(--text);font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol;padding-bottom:calc(var(--dock-h) + env(safe-area-inset-bottom) + 16px);}
    img{display:block;max-width:100%;height:auto;border-radius:12px}
    button{cursor:pointer;border:0}
    .container{max-width:980px;margin:0 auto;padding:0 var(--gutter) calc(96px + var(--dock-h) + env(safe-area-inset-bottom));}

    /* 顶部导航 */
    .nav{position:sticky;top:0;z-index:40;backdrop-filter:saturate(180%) blur(8px);background:rgba(255,255,255,.8);border-bottom:1px solid var(--muted)}
    .nav-inner{display:flex;align-items:center;justify-content:space-between;padding:12px var(--gutter)}
    .brand{display:flex;align-items:center;gap:10px;font-size:18px;font-weight:700;color:var(--brand)}
    .brand svg{width:24px;height:24px}
    .actions{display:flex;align-items:center;gap:10px}
    .icon-btn{width:40px;height:40px;border-radius:12px;background:#fff;border:1px solid var(--muted);display:grid;place-items:center;box-shadow:var(--shadow)}

    /* 主体：产品信息 */
    .product{display:grid;gap:16px;margin:16px 0}
    @media(min-width:860px){.product{grid-template-columns:1.1fr .9fr;align-items:start}}

    .gallery{position:relative;background:var(--card);padding:12px;border-radius:var(--radius);box-shadow:var(--shadow)}
    .thumbs{display:flex;gap:8px;margin-top:10px;overflow-x:auto;padding-bottom:4px}
    .thumbs img{width:72px;height:72px;object-fit:cover;border:2px solid transparent;flex:0 0 auto}
    .thumbs img[aria-selected="true"]{border-color:var(--brand)}

    .info{background:var(--card);padding:16px;border-radius:var(--radius);box-shadow:var(--shadow)}
    .title{font-size:20px;font-weight:700;line-height:1.3;margin:0}
    .price{display:flex;align-items:baseline;gap:10px;margin:8px 0 12px}
    .price .now{font-size:22px;font-weight:800;color:#111}
    .price .old{color:var(--sub);text-decoration:line-through}
    .meta{display:flex;flex-wrap:wrap;gap:8px;color:var(--sub);font-size:14px}
    .cta{display:flex;gap:10px;margin-top:14px}
    .btn{padding:12px 16px;border-radius:12px;font-weight:700}
    .btn-primary{background:var(--brand);color:#fff}
    .btn-ghost{background:#fff;border:1px solid var(--muted);color:#111}

    /* 详情/规格 */
    .details{margin-top:16px}
    .pill{display:inline-block;background:#f3f4f6;padding:6px 10px;border-radius:999px;font-size:12px;color:#111}

    /* 评论区 */
    .reviews{margin:24px 0}
    .section-title{font-size:18px;font-weight:800;margin:0 0 10px}
    .rating-summary{display:flex;align-items:center;gap:8px;color:#111}
    .stars{display:inline-flex;gap:2px}
    .stars svg{width:18px;height:18px}

    .review-list{display:grid;gap:12px}
    .review-card{background:var(--card);padding:12px;border-radius:var(--radius);box-shadow:var(--shadow)}
    .review-head{display:flex;align-items:center;gap:10px}
    .avatar{width:36px;height:36px;border-radius:50%;background:#ddd;flex:0 0 auto}
    .who{display:flex;flex-direction:column}
    .name{font-size:14px;font-weight:700}
    .date{font-size:12px;color:var(--sub)}

    /* 自定义音频条 */
    .audio{display:grid;grid-template-columns:40px 1fr 60px;gap:10px;align-items:center;margin-top:10px}
    .play{width:40px;height:40px;border-radius:12px;background:#111;color:#fff;display:grid;place-items:center}
    .bar{position:relative;height:8px;background:#eef2ff;border-radius:999px;overflow:hidden}
    .bar .fill{position:absolute;left:0;top:0;bottom:0;width:0;background:var(--brand)}
    .time{font-variant-numeric:tabular-nums;color:var(--sub);font-size:12px;text-align:right}

    /* 发表语音评论 */
    .composer{margin-top:16px;background:var(--card);padding:12px;border-radius:var(--radius);box-shadow:var(--shadow)}
    .composer h4{margin:0 0 8px;font-size:16px}
    .row{display:grid;gap:8px}
    @media(min-width:560px){.row{grid-template-columns:1fr 1fr}}
    .input,.textarea,.select{width:100%;padding:12px;border:1px solid var(--muted);border-radius:12px;background:#fff}
    .textarea{min-height:72px;resize:vertical}
    .uploader{display:flex;align-items:center;gap:10px;padding:10px;border:1px dashed var(--muted);border-radius:12px;background:#fafafa}
    .submit{margin-top:10px;display:flex;gap:10px}

    /* 底部吸附操作条（移动端） */
    .dock{position:fixed;left:0;right:0;bottom:0;background:#fff;border-top:1px solid var(--muted);padding:10px var(--gutter);display:flex;gap:10px;padding-bottom:calc(10px + env(safe-area-inset-bottom));z-index:9999}.dock .btn{flex:1}
    .dock .btn{flex:1}

    /* 小提示 */
    .tip{font-size:12px;color:var(--sub)}
  /* 评论区（占位样式） */
    .filter{display:flex;gap:8px;flex-wrap:wrap;margin:10px 0}
    .chip{padding:6px 10px;border:1px solid var(--muted);background:#fff;border-radius:999px;font-size:12px}
    .chip.active{background:var(--brand);border-color:var(--brand);color:#fff}

    .review-list{display:grid;gap:12px}
    .card{background:var(--card);padding:12px;border-radius:var(--radius);box-shadow:var(--shadow)}
    .card .head{display:flex;align-items:center;gap:10px;justify-content:space-between}
    .audio{display:grid;grid-template-columns:36px 1fr auto auto;gap:10px;align-items:center;margin-top:8px}
    .audio .bar{height:8px;background:#eef2ff;border-radius:999px;overflow:hidden}
    .audio .prog{height:100%;width:0;background:var(--brand)}
.viewer.show{display:flex !important}
</style>
</head>
<body>
  <!-- 顶部导航 -->
  <nav class="nav" role="navigation" aria-label="顶部导航">
    <div class="nav-inner">
      <div class="brand" aria-label="品牌">
        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path d="M12 2l2.39 4.84 5.34.78-3.86 3.76.91 5.32L12 14.77 6.22 16.7l.91-5.32L3.27 7.62l5.34-.78L12 2z" fill="currentColor"/></svg>
        NeoShop
      </div>
      <div class="actions">
        <button class="icon-btn" aria-label="搜索">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
        </button>
        <button class="icon-btn" aria-label="购物车">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><circle cx="9" cy="21" r="1"></circle><circle cx="20" cy="21" r="1"></circle><path d="M1 1h4l2.68 12.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path></svg>
        </button>
      </div>
    </div>
  </nav>

  <main class="container">
    <!-- 产品信息 -->
    <section class="product" aria-label="产品">
      <div class="gallery" aria-label="产品图">
        <img id="mainImg" src="https://picsum.photos/seed/headphone/800/600" alt="产品主图" loading="lazy"/>
        <div class="thumbs" id="thumbs" role="listbox" aria-label="缩略图">
        </div>
      </div>

      <div class="info">
        <h1 class="title">Neo 大容量U盘</h1>
        <div class="price">
          <div class="now">¥ 39</div>
          <span class="pill">现货</span>
        </div>
        <div class="meta">
          <span>包邮</span>·<span>7 天无理由</span>·<span>一年质保</span>
        </div>
        <div class="cta">
          <button class="btn btn-ghost" aria-label="加入愿望单">加入愿望单</button>
          <button class="btn btn-primary" aria-label="加入购物车">加入购物车</button>
        </div>
        <div class="details">
          <div class="pill">128GB</div>
          <div class="pill">200MB/s 读取速度</div>
          <div class="pill">金属外壳 防震抗摔</div>
        </div>
      </div>
    </section>

    <!-- 评论区 -->
    <section class="reviews" aria-label="评论区">
      <h2 class="section-title">用户评价</h2>

      <!-- 筛选条（点击 .chip 切换，data-key 对应 tagKeys） -->
      <div class="filter" role="tablist" aria-label="筛选">
      </div>

      <!-- 列表容器：你的脚本将把卡片插入到这里 -->
      <div id="list" class="review-list" aria-live="polite"></div>

      <!-- 卡片模板：字段名与脚本保持一致 -->
      <template id="card-tpl">
        <article class="card" aria-label="评价卡片">
          <header class="head">
            <div style="display:flex;align-items:baseline;gap:8px">
              <div class="name" style="font-weight:700">用户</div>
              <div class="date" style="font-size:12px;color:var(--sub)">2025-01-01</div>
            </div>
            <div class="stars" aria-label="星级">★★★★★</div>
          </header>

          <div class="tags" aria-label="标签" style="display:flex;gap:6px;flex-wrap:wrap"></div>

          <div class="audio" aria-label="语音">
            <button class="play" aria-label="播放">
              <svg viewBox="0 0 24 24" width="20" height="20"><path d="M8 5v14l11-7z" fill="currentColor"/></svg>
            </button>
            <div class="bar" aria-label="进度条"><div class="prog"></div></div>
            <div class="time"><span class="cur">00:00</span>/<span class="dur">--:--</span></div>
            <div class="status tip">未上传音频</div>
          </div>

          <div class="photos" aria-label="配图" style="margin-top:10px">
            <div class="grid" style="display:grid;grid-template-columns:repeat(3,1fr);gap:6px"></div>
          </div>
        </article>
      </template>

      <!-- 图片查看器占位：你的脚本将控制显示/隐藏 -->
      <div id="viewer" class="viewer" aria-hidden="true" style="position:fixed;inset:0;background:rgba(0,0,0,.8);display:none;align-items:center;justify-content:center;padding:20px;z-index:1000">
        <img id="viewerImg" alt="大图预览" style="max-width:100%;max-height:100%;border-radius:12px"/>
      </div>

      <p class="tip" style="margin-top:8px">提示：评论渲染逻辑请粘贴你的脚本（含 <code>reviews</code> 数据、筛选与播放器），本页面仅提供结构占位。</p>
    </section>
  </main>

  <!-- 底部吸附操作条（移动端优先） -->
  <div class="dock" aria-label="底部操作">
    <button class="btn btn-ghost" aria-label="收藏">收藏</button>
    <button class="btn btn-primary" aria-label="立即购买">立即购买</button>
  </div>

  <script>
  // ====== 产品图：缩略图切换（保留） ======
  (function(){
    const mainImg = document.getElementById('mainImg');
    const thumbs = document.getElementById('thumbs');
    if(thumbs && mainImg){
      thumbs.addEventListener('click', (e)=>{
        const t = e.target.closest('img');
        if(!t) return;
        Array.from(thumbs.querySelectorAll('img')).forEach(img=>img.setAttribute('aria-selected','false'));
        t.setAttribute('aria-selected','true');
        mainImg.src = t.src.replace('/200/200','/800/600');
        mainImg.alt = t.alt + '（主图）';
      });
    }
  })();

  // ================ 评论脚本（含 reviews、筛选与播放器逻辑） ================
  // tagKeys: family / business / transport / quiet / breakfast / onsen
  const reviews = [
    { id:1,  name:"用户 A", date:"2025-09-17", stars:"★★★★★", tags:[], tagKeys:["transport"], audioSrc:"voice/1.m4a", durationHint:null, photos:["image/1-1.jpg","image/1-2.jpg","image/1-3.jpg"] },
    { id:2,  name:"用户 B", date:"2025-09-10", stars:"★★★★☆", tags:[], tagKeys:["transport","breakfast"], audioSrc:"voice/2.m4a", durationHint:null, photos:["image/2-1.jpg","image/2-2.jpg","image/2-3.jpg"] },
    { id:3,  name:"用户 C", date:"2025-09-04", stars:"★★★☆☆", tags:[], tagKeys:["quiet"], audioSrc:"voice/3.m4a", durationHint:null, photos:["image/3-1.jpg","image/3-2.jpg","image/3-3.jpg"] },
    { id:4,  name:"用户 D", date:"2025-08-19", stars:"★★★★★", tags:[], tagKeys:["family"], audioSrc:"voice/4.m4a", durationHint:null, photos:["image/4-1.jpg","image/4-2.jpg","image/4-3.jpg"] },
    { id:5,  name:"用户 E", date:"2025-08-18", stars:"★☆☆☆☆", tags:[], tagKeys:["business"], audioSrc:"voice/5.m4a", durationHint:null, photos:["image/5-1.jpg","image/5-2.jpg","image/5-3.jpg"] },
    { id:6,  name:"用户 F", date:"2025-08-18", stars:"★★★★☆", tags:[], tagKeys:[], audioSrc:"voice/6.m4a", durationHint:null, photos:["image/6-1.jpg","image/6-2.jpg","image/6-3.jpg"] },
    { id:7,  name:"用户 G", date:"2025-08-08", stars:"★★★★★", tags:[], tagKeys:[], audioSrc:"voice/7.m4a", durationHint:null, photos:["image/7-1.jpg","image/7-2.jpg"] },
    { id:8,  name:"用户 H", date:"2025-08-03", stars:"★★★★☆", tags:[], tagKeys:["onsen"], audioSrc:"voice/8.m4a", durationHint:null, photos:["image/8-1.jpg","image/8-2.jpg"] },
    { id:9,  name:"用户 I", date:"2025-08-02", stars:"★★★☆☆", tags:[], tagKeys:["business"], audioSrc:"voice/9.mp3", durationHint:null, photos:["image/9-1.jpg","image/9-2.jpg","image/9-3.jpg"] },
    { id:10, name:"用户 J", date:"2025-08-02", stars:"★★★★★", tags:[], tagKeys:["quiet"], audioSrc:"voice/10.m4a", durationHint:null, photos:["image/10-1.jpg","image/10-2.jpg"] }
  ];

  // 工具：将秒数格式化为 mm:ss
  const fmt = s=>{ if(!Number.isFinite(s)) return "--:--"; const m=String(Math.floor(s/60)).padStart(2,'0'); const ss=String(Math.floor(s%60)).padStart(2,'0'); return `${m}:${ss}`; };

  const $list = document.getElementById('list');
  const tpl = document.getElementById('card-tpl');
  const filterBar = document.querySelector('.filter');

  let currentAudio = null; // 确保同一时间只有一个在播
  let curFilter = 'all';

  function createCard(data){
    const node = tpl.content.cloneNode(true);
    const card = node.querySelector('.card');
    card.dataset.id = data.id;
    card.dataset.tagKeys = (data.tagKeys||[]).join(',');
    card.querySelector('.name').textContent = data.name;
    card.querySelector('.date').textContent = data.date;
    card.querySelector('.stars').textContent = data.stars;
    const tagsWrap = card.querySelector('.tags');
    data.tags.forEach(t=>{ const span=document.createElement('span'); span.className='tag'; span.textContent=t; tagsWrap.appendChild(span); });

    // 音频
    const playBtn = card.querySelector('.play');
    const curEl = card.querySelector('.cur');
    const durEl = card.querySelector('.dur');
    const progEl = card.querySelector('.prog');
    const statusEl = card.querySelector('.status');

    const audio = new Audio();
    audio.preload = 'metadata';
    if(data.audioSrc){ audio.src = data.audioSrc; }

    const noAudio = !data.audioSrc;
    playBtn.disabled = noAudio;
    statusEl.classList.toggle('missing', noAudio);
    statusEl.textContent = noAudio ? '未上传音频' : '可播放';
    if(data.durationHint) durEl.textContent = fmt(data.durationHint);

    // 元数据加载
    audio.addEventListener('loadedmetadata', ()=>{ durEl.textContent = fmt(audio.duration); });

    function pauseOthers(){
      if(currentAudio && currentAudio!==audio){
        currentAudio.pause();
        if(currentAudio.__btn){ currentAudio.__btn.innerHTML = '<svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z" fill="currentColor"/></svg>'; }
      }
      currentAudio = audio; currentAudio.__btn = playBtn;
    }

    // 播放/暂停
    playBtn.addEventListener('click', async ()=>{
      if(audio.paused){
        pauseOthers();
        try{ await audio.play(); playBtn.innerHTML = '<svg viewBox="0 0 24 24"><path d="M6 4h4v16H6zM14 4h4v16h-4z" fill="currentColor"/></svg>'; }
        catch(e){ console.warn(e); }
      } else {
        audio.pause();
        playBtn.innerHTML = '<svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z" fill="currentColor"/></svg>';
      }
    });

    // 进度与结束
    audio.addEventListener('timeupdate', ()=>{
      curEl.textContent = fmt(audio.currentTime);
      const ratio = audio.duration? (audio.currentTime / audio.duration) : 0;
      progEl.style.width = `${(ratio*100).toFixed(2)}%`;
    });
    audio.addEventListener('ended', ()=>{
      playBtn.innerHTML = '<svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z" fill="currentColor"/></svg>';
      progEl.style.width='0%';
      curEl.textContent='00:00';
    });

    // 点击进度条跳转
    const bar = card.querySelector('.bar');
    bar.addEventListener('click', (e)=>{ if(!audio.duration) return; const rect = bar.getBoundingClientRect(); const ratio = (e.clientX - rect.left)/rect.width; audio.currentTime = Math.max(0, Math.min(audio.duration, ratio*audio.duration)); });

    // 图片
    const photosWrap = card.querySelector('.photos');
    const grid = card.querySelector('.photos .grid');
    if(Array.isArray(data.photos) && data.photos.length){
      data.photos.forEach((src,idx)=>{
        const box = document.createElement('div');
        box.className = 'thumb';
        const img = document.createElement('img');
        img.alt = `图片${idx+1}`; img.src = src;
        box.appendChild(img);
        box.addEventListener('click', ()=> openViewer(src));
        grid.appendChild(box);
      });
    } else {
      photosWrap.style.display = 'none';
    }

    return node;
  }

  // 渲染列表（带筛选）
  function render(){
    $list.innerHTML = '';
    reviews.forEach(r=>{
      if(curFilter==='all' || (r.tagKeys||[]).includes(curFilter)){
        const frag = createCard(r);
        $list.appendChild(frag);
      }
    });
  }

  // 处理筛选点击
  filterBar.addEventListener('click', (e)=>{
    const item = e.target.closest('.chip');
    if(!item) return;
    document.querySelectorAll('.chip').forEach(ch=>ch.classList.remove('active'));
    item.classList.add('active');
    curFilter = item.dataset.key || 'all';
    render();
  });

  // 初始渲染
  render();

  // 简易图片查看器
  const viewer = document.getElementById('viewer');
  const viewerImg = document.getElementById('viewerImg');
  function openViewer(src){ viewerImg.src = src; viewer.classList.add('show'); viewer.setAttribute('aria-hidden','false'); }
  viewer.addEventListener('click', ()=>{ viewer.classList.remove('show'); viewer.setAttribute('aria-hidden','true'); viewerImg.removeAttribute('src'); });

  // 使用说明：
  // 1）替换头部酒店信息（名称、位置、价格）；
  // 2）在 reviews 中填入住客语音与房型/设施照片；
  // 3）用 tagKeys 让该条评论出现在对应筛选下（family/business/transport/quiet/breakfast/onsen）。
</script>
</body>
</html>



